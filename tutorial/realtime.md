# Tutorial: Real-time Processing with Arrp

Real-time processing usually requires low input-output latency. The best way to achieve this is to generate C++ code from Arrp and tightly integrated it with real-time audio capture and playback using C++.

The file `onsets-rt-host.cpp` contains a C++ program that integrates the onset detector written in Arrp as described in the [previous part](onsets.html) of the tutorial.

Compiling the complete program requires the [RtAudio library](https://www.music.mcgill.ca/~gary/rtaudio/).

The complete program can be compiled in two steps (note that we are using `onsets-solution.arrp` instead of `onsets.arrp`):

- Generate C++ from Arrp: `arrp onsets-solution.arrp --cpp onsets.cpp`
- Compile C++: `c++ onsets-rt-host.cpp -o onsets-rt -lrtaudio -lpthread`

The last step generates the program `onsets-rt`. This program captures the first channel of the default audio capture device (as defined by RtAudio) and processes the audio using the C++ code generated from Arrp. The output is printed in the console.

The above steps are also defined in the Makefile so you can use `make onsets-rt` instead.

## Alternative Real-time Solution

Real-time processing can also be achieved without writing any C++ code - using existing programs that can capture and play audio while communicating over pipes with the executable generated by the Arrp compiler.

An example is in the bash script `run-onsets-realtime.sh`. The script uses the `arecord` program (part of the [ALSA project](https://alsa-project.org/)) to capture audio, then converts the sample format using `ffmpeg` and finally passes the data to the onset detector written in Arrp.

To use this solution:

- Generate the onset detector executable from Arrp: `make onsets-solution` or `arrp onsets-solution.arrp -x onsets-solution`.
- Run the script: `./run-onsets-realtime.sh`

